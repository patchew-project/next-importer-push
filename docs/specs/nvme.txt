NVM Express Controller
======================

The nvme device (-device nvme) emulates an NVM Express Controller. It is used
together with nvme-ns devices (-device nvme-ns) which emulates an NVM Express
Namespace.

nvme-ns Options
---------------

  `lbads`; The "LBA Data Size (LBADS)" indicates the LBA data size used by the
     namespace. It is specified in terms of a power of two. Only values between
     9 and 12 (both inclusive) are supported.

  `iocs`; The "I/O Command Set" associated with the namespace. E.g. 0x0 for the
     NVM Command Set (the default), or 0x2 for the Zoned Namespace Command Set.

  `pstate`; This parameter specifies another blockdev to be used for storing
     persistent state such as logical block allocation tracking. Adding this
     parameter enables various optional features of the device.

       -drive id=pstate,file=pstate.img,format=raw
       -device nvme-ns,pstate=pstate,...

     To reset (or initialize) state, the blockdev image should be of zero size:

       qemu-img create -f raw pstate.img 0

     The image will be intialized with a file format header and truncated to
     the required size.

     If the pstate given is of non-zero size, it will be assumed to contain
     previous saved state and will be checked for consistency. If any stored
     values (such as lbads) differs from those specified for the nvme-ns
     device an error is produced.


Reference Specifications
------------------------

The device currently implements most mandatory features of NVMe v1.3d, see

  https://nvmexpress.org/resources/specifications/

for the specification.


Known issues
------------

* The accounting numbers in the SMART/Health are reset across power cycles

* Interrupt Coalescing is not supported and is disabled by default in volation
  of the specification.
